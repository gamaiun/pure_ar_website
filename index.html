<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AR Objects with GPS</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
  </head>
  <body>
    <a-scene
      arjs="sourceType: webcam; debugUIEnabled: false;"
      renderer="logarithmicDepthBuffer: true;"
    >
      <!-- Camera with GPS tracking -->
      <a-camera gps-camera rotation-reader position="0 1.6 0"></a-camera>

      <!-- 3D Model - 2 meters northwest (x=-2, z=-2), scaled down by half -->
      <a-entity
        id="sphere"
        position="-2 0.5 -2"
        scale="0.5 0.5 0.5"
        gltf-model="url(https://firebasestorage.googleapis.com/v0/b/fireye-91940.firebasestorage.app/o/models%2FARObject1.glb?alt=media&token=a68ba586-0c9b-48c4-9bb1-9e25f430e1c8)"
      ></a-entity>
    </a-scene>

    <script>
      window.onload = () => {
        const scene = document.querySelector("a-scene");
        const sphere = document.querySelector("#sphere");

        scene.addEventListener("loaded", () => {
          console.log("Scene loaded");

          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
              (position) => {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                console.log(`Your location: Lat ${latitude}, Lon ${longitude}`);

                sphere.setAttribute("gps-entity-place", {
                  latitude: latitude,
                  longitude: longitude,
                });
              },
              (error) => {
                console.error("GPS Error:", error.message);
              },
              { enableHighAccuracy: true }
            );
          } else {
            console.error("Geolocation not supported.");
          }
        });
      };
    </script>
  </body>
</html>
